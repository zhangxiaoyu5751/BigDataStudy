
- [MySQL 索引相关问题](#mysql-索引相关问题)
    - [常见的索引类型](#常见的索引类型)
        - [哈希索引](#哈希索引)
            - [哈希索引的限制](#哈希索引的限制)
        - [b+树索引（O(logn)）](#b树索引ologn)
                - [为什么不用红黑树或者二叉排序树？](#为什么不用红黑树或者二叉排序树)
            - [为什么不用b树？](#为什么不用b树)
        - [全文索引](#全文索引)
        - [空间索引](#空间索引)

# MySQL 索引相关问题

## 什么叫索引？
索引是帮助mysql高效获取数据的一种数据结构，他存储在磁盘上，用它来提高查询效率。

## 常见的索引类型

### 哈希索引
    哈希索引是是基于哈希表实现的，只有精确匹配索引的所有列才有效

    索引本身只存储对应的哈希值，所以使用哈希索引查找速度非常快，但是哈希索引也有限制

#### 哈希索引的限制
- 哈希索引只包含哈希值和索引指针，而不存储字段的值，所以不能直接使用索引中的值来避免读取行。但是由于哈希索引是在内存中读取，所以对性能影响并不是很明显
- 哈希索引并不是按照索引值顺序存储的，所以无法用来排序
- 哈希索引并不支持最左前缀匹配。因为哈希索引始终是使用索引列的全部内容进行计算和匹配的
- 哈希索引只支持等值查询，并不支持范围查询
- 数据量大的话 可能会形成哈希冲突，如果发生哈希冲突，维护变得很困难

### b+树索引（O(logn)）

- 索引都是按照索引值排序的，很适合范围查找数据。相邻的叶子节点之间是有指针相连的 而b树非叶子节点也是存储数据的。同时b树的叶子节点之间没有指针相连。
- B+树的设计可以允许数据分批加载，同时树的高度较低，提高查找效率。
  

  **B树在提高了IO性能的同时并没有解决元素遍历的我效率低下的问题，正是为了解决这个问题，B+树应用而生。B+树只需要去遍历叶子节点就可以实现整棵树的遍历。而且在数据库中基于范围的查询是非常频繁的，而B树不支持这样的操作或者说效率太低。**

http://blog.codinglabs.org/articles/theory-of-mysql-index.html
https://my.oschina.net/lienson/blog/2987474
##### 为什么不用红黑树或者二叉排序树？
    一般来说，索引本身会很大，不可能所有的索引都放到内存当中，所以索引通常是以索引文件的形式存储在磁盘上，这样的话，索引的查找过程中就产生磁盘消耗，相对于内存的存取来说，IO消耗要多好几个数量级。所以评价一个数据结构作为索引的优劣最重要的指标是查找过程中磁盘的IO次数。换句话说，索引的结构组织要尽量减少查找过程中磁盘的IO存取。查找过程中要进行多次的磁盘读取操作。同时，由于数据库采用了磁盘预读原理，(也就是说只需要一个字节的话 也会把整个一页加载到内存中。) 吧一个节点大小设置成一页，这样每个节点只需要一次IO 就可以全部载入。

    答：树的查询时间跟树的高度有关，B+树是一棵多路搜索树可以降低树的高度，提高查找效率，同时由于逻辑上很近的节点在物理上可能很远，无法利用局部性。

#### 为什么不用b树？
    因为B树不管叶子节点还是非叶子节点，都会保存数据，这样导致在非叶子节点中能保存的指针数量变少，
    指针少的情况下要保存大量数据，只能增加树的高度，每次读入的数据量是一定的，单个数据变大，导致IO操作变多，查询性能变低。同时，b树不支持范围查找，只能通过中序遍历，效率太低

### 为什么建议使用自增主键作为索引：
    因为根据b+树的特点，自增主键是连续的，这样在插入过程中减少了数据也的分裂，以及数据的移动，每次插入都插入到最后

### 全文索引

### 空间索引
